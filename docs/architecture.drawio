<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/29.0.3 Chrome/140.0.7339.249 Electron/38.7.0 Safari/537.36" version="29.0.3">
  <diagram name="YiRage Architecture" id="yirage-arch">
    <mxGraphModel dx="1009" dy="863" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="YiRage Multi-Backend Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="400" y="20" width="600" height="40" as="geometry" />
        </mxCell>
        <mxCell id="python-layer" value="Python API Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=16;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="100" y="80" width="1200" height="70" as="geometry" />
        </mxCell>
        <mxCell id="python-api-1" value="yr.get_available_backends()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="120" y="110" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="python-api-2" value="yr.PersistentKernel()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="345" y="110" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="python-api-3" value="Backend Optimizers" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="540" y="110" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="python-api-4" value="Search Strategies" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="740" y="110" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="python-api-5" value="Kernel Graph API" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="920" y="110" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="python-api-6" value="MACA Config" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00" parent="1" vertex="1">
          <mxGeometry x="1100" y="110" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="backend-manager" value="Backend Manager (C++)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=16;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="100" y="180" width="1200" height="80" as="geometry" />
        </mxCell>
        <mxCell id="backend-registry" value="BackendRegistry&#xa;(Singleton)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" parent="1" vertex="1">
          <mxGeometry x="120" y="220" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="backend-factory" value="Factory Pattern" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" parent="1" vertex="1">
          <mxGeometry x="320" y="220" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="kernel-factory" value="KernelExecutor&#xa;Factory" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" parent="1" vertex="1">
          <mxGeometry x="490" y="220" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="search-factory" value="SearchStrategy&#xa;Factory" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" parent="1" vertex="1">
          <mxGeometry x="660" y="220" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="dim-strategy" value="DimStrategy&#xa;(warp_size)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" parent="1" vertex="1">
          <mxGeometry x="830" y="220" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="auto-init" value="Auto Initialize&#xa;on Import" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" parent="1" vertex="1">
          <mxGeometry x="1000" y="220" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="parallel-search" value="OpenMP&#xa;Parallel" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" parent="1" vertex="1">
          <mxGeometry x="1140" y="220" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="backends-title" value="Backend Implementations (9)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="100" y="280" width="1200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="cuda-backend" value="CUDA Backend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="110" y="340" width="120" height="180" as="geometry" />
        </mxCell>
        <mxCell id="cuda-opt" value="CUDAOptimizer&#xa;• Tensor Core&#xa;• Warp (32)&#xa;• Bank Conflict&#xa;• Occupancy" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;dashed=1;dashPattern=1 1;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="115" y="365" width="110" height="70" as="geometry" />
        </mxCell>
        <mxCell id="cuda-search" value="CUDASearch&#xa;• 4 dimensions&#xa;• 4 metrics" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;dashed=1;dashPattern=1 1;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="115" y="445" width="110" height="65" as="geometry" />
        </mxCell>
        <mxCell id="maca-backend" value="MACA Backend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="240" y="340" width="120" height="180" as="geometry" />
        </mxCell>
        <mxCell id="maca-opt" value="MACAOptimizer&#xa;• Warp (64)&#xa;• CUDA compat&#xa;• mxcc/mctlass&#xa;• mcPytorch" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;dashed=1;dashPattern=1 1;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="245" y="365" width="110" height="70" as="geometry" />
        </mxCell>
        <mxCell id="maca-search" value="MACASearch&#xa;• 64-thread warp&#xa;• GPU fingerprint" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;dashed=1;dashPattern=1 1;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="245" y="445" width="110" height="65" as="geometry" />
        </mxCell>
        <mxCell id="cpu-backend" value="CPU Backend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="370" y="340" width="120" height="180" as="geometry" />
        </mxCell>
        <mxCell id="cpu-opt" value="CPUOptimizer&#xa;• SIMD (AVX512)&#xa;• Cache Block&#xa;• OpenMP&#xa;• Vectorization" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;dashed=1;dashPattern=1 1;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="375" y="365" width="110" height="70" as="geometry" />
        </mxCell>
        <mxCell id="cpu-search" value="CPUSearch&#xa;• 3 dimensions&#xa;• 3 metrics" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;dashed=1;dashPattern=1 1;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="375" y="445" width="110" height="65" as="geometry" />
        </mxCell>
        <mxCell id="mps-backend" value="MPS Backend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="500" y="340" width="120" height="180" as="geometry" />
        </mxCell>
        <mxCell id="mps-opt" value="MPSOptimizer&#xa;• GPU Family&#xa;• Threadgroup&#xa;• Unified Mem&#xa;• SIMD-32" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;verticalAlign=middle;dashed=1;dashPattern=1 1;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="505" y="365" width="110" height="70" as="geometry" />
        </mxCell>
        <mxCell id="mps-search" value="MPSSearch&#xa;• 3 dimensions&#xa;• 3 metrics" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;verticalAlign=middle;labelBackgroundColor=none;dashed=1;dashPattern=1 1;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="505" y="445" width="110" height="65" as="geometry" />
        </mxCell>
        <mxCell id="ascend-backend" value="Ascend Backend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#cc0000;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="630" y="340" width="120" height="180" as="geometry" />
        </mxCell>
        <mxCell id="ascend-opt" value="AscendOptimizer&#xa;• AI Core&#xa;• Cube Unit&#xa;• L1 Buffer&#xa;• BiSheng" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="635" y="365" width="110" height="70" as="geometry" />
        </mxCell>
        <mxCell id="ascend-search" value="AscendSearch&#xa;• 3 dimensions&#xa;• NPU metrics" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="635" y="445" width="110" height="65" as="geometry" />
        </mxCell>
        <mxCell id="triton-backend" value="Triton" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="760" y="340" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="triton-opt" value="Block&#xa;Pipelining&#xa;Split-K" style="rounded=0;whiteSpace=wrap;html=1;align=center;fontSize=10;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="765" y="365" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="nki-backend" value="NKI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="760" y="440" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="nki-opt" value="SBUF&#xa;DMA&#xa;BF16" style="rounded=0;whiteSpace=wrap;html=1;align=center;fontSize=10;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="765" y="460" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cudnn-backend" value="cuDNN" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="870" y="340" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="cudnn-opt" value="Algorithm&#xa;MathType&#xa;Workspace" style="rounded=0;whiteSpace=wrap;html=1;align=center;fontSize=10;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="875" y="365" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="mkl-backend" value="MKL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="870" y="440" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="mkl-opt" value="Threading&#xa;BLAS&#xa;Fast MM" style="rounded=0;whiteSpace=wrap;html=1;align=center;fontSize=10;fillColor=#ffffff;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="875" y="460" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hardware-title" value="Target Hardware" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="100" y="560" width="1200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hw-nvidia" value="NVIDIA GPU&#xa;(Ampere/Hopper)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" parent="1" vertex="1">
          <mxGeometry x="110" y="610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-metax" value="MetaX GPU&#xa;(C500/C550)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00" parent="1" vertex="1">
          <mxGeometry x="240" y="610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-cpu" value="x86/ARM CPU&#xa;(Intel/AMD/Apple)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" parent="1" vertex="1">
          <mxGeometry x="370" y="610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-apple" value="Apple Silicon&#xa;(M1/M2/M3/M4)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" parent="1" vertex="1">
          <mxGeometry x="500" y="610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-ascend" value="Huawei Ascend&#xa;(910/910B/310P)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#cc0000" parent="1" vertex="1">
          <mxGeometry x="630" y="610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-aws" value="AWS Neuron&#xa;(Inferentia/Trainium)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="760" y="610" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-accel" value="Accelerators&#xa;(cuDNN/MKL)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="910" y="610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="arrow-ascend-hw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1" parent="1" source="ascend-backend" target="hw-ascend" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;exitX=0.5;exitY=1;" parent="1" source="python-layer" target="backend-manager" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-cuda-hw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1" parent="1" source="cuda-backend" target="hw-nvidia" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-maca-hw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1" parent="1" source="maca-backend" target="hw-metax" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-cpu-hw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1" parent="1" source="cpu-backend" target="hw-cpu" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-mps-hw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1" parent="1" source="mps-backend" target="hw-apple" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="stats" value="YiRage Stats&#xa;━━━━━━━━━━&#xa;9 Backends&#xa;50+ Optimizers&#xa;7 Search Strategies&#xa;25K+ Lines of Code&#xa;━━━━━━━━━━&#xa;M3 Mac Ready ✓&#xa;Ascend NPU ✓&#xa;MetaX C500 ✓" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=center;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1050" y="340" width="140" height="180" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=11;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1210" y="340" width="50" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend1" value="NVIDIA GPU" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="1210" y="365" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend2" value="MetaX GPU" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="1210" y="390" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend3" value="CPU" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="1210" y="415" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend4" value="Apple" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="1210" y="440" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend5" value="Ascend NPU" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffcccc;strokeColor=#cc0000;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="1210" y="465" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend6" value="Specialized" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=9" parent="1" vertex="1">
          <mxGeometry x="1210" y="490" width="80" height="20" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
