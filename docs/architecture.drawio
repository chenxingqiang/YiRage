<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/29.0.3 Chrome/140.0.7339.249 Electron/38.7.0 Safari/537.36" version="29.0.3">
  <diagram name="YiRage Architecture" id="yirage-arch">
    <mxGraphModel dx="1177" dy="1007" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="800" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="YiRage Multi-Backend Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="300" y="20" width="600" height="40" as="geometry" />
        </mxCell>
        <mxCell id="python-layer" value="Python API Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=16;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="100" y="80" width="1000" height="70" as="geometry" />
        </mxCell>
        <mxCell id="python-api-1" value="yr.get_available_backends()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="120" y="110" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="python-api-2" value="yr.PersistentKernel()" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="345" y="110" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="python-api-3" value="Backend Optimizers" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="540" y="110" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="python-api-4" value="Search Strategies" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="740" y="110" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="python-api-5" value="Kernel Graph API" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="920" y="110" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="backend-manager" value="Backend Manager (C++)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=16;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="100" y="180" width="1000" height="80" as="geometry" />
        </mxCell>
        <mxCell id="backend-registry" value="BackendRegistry&#xa;(Singleton)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" parent="1" vertex="1">
          <mxGeometry x="120" y="220" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="backend-factory" value="Factory Pattern" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" parent="1" vertex="1">
          <mxGeometry x="320" y="220" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="kernel-factory" value="KernelExecutor&#xa;Factory" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" parent="1" vertex="1">
          <mxGeometry x="525" y="220" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="search-factory" value="SearchStrategy&#xa;Factory" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666" parent="1" vertex="1">
          <mxGeometry x="730" y="220" width="150" height="30" as="geometry" />
        </mxCell>
        <mxCell id="auto-init" value="Auto Initialize&#xa;on Import" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656" parent="1" vertex="1">
          <mxGeometry x="920" y="220" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="backends-title" value="Backend Implementations (7)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="100" y="280" width="1000" height="40" as="geometry" />
        </mxCell>
        <mxCell id="cuda-backend" value="CUDA Backend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="110" y="340" width="130" height="180" as="geometry" />
        </mxCell>
        <mxCell id="cuda-opt" value="CUDAOptimizer&#xa;• Tensor Core&#xa;• Warp&#xa;• Bank Conflict&#xa;• Occupancy" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="115" y="365" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="cuda-search" value="CUDASearch&#xa;• 4 dimensions&#xa;• 4 metrics" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="115" y="445" width="120" height="65" as="geometry" />
        </mxCell>
        <mxCell id="cpu-backend" value="CPU Backend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="260" y="340" width="130" height="180" as="geometry" />
        </mxCell>
        <mxCell id="cpu-opt" value="CPUOptimizer&#xa;• SIMD (AVX512)&#xa;• Cache Block&#xa;• OpenMP&#xa;• Vectorization" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="265" y="365" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="cpu-search" value="CPUSearch&#xa;• 3 dimensions&#xa;• 3 metrics" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="265" y="445" width="120" height="65" as="geometry" />
        </mxCell>
        <mxCell id="mps-backend" value="MPS Backend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="410" y="340" width="130" height="180" as="geometry" />
        </mxCell>
        <mxCell id="mps-opt" value="MPSOptimizer&#xa;• GPU Family&#xa;• Threadgroup&#xa;• Unified Mem&#xa;• SIMD-32" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="415" y="365" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="mps-search" value="MPSSearch&#xa;• 3 dimensions&#xa;• 3 metrics" style="rounded=0;whiteSpace=wrap;html=1;align=center;fillColor=#ffffff;verticalAlign=middle;labelBackgroundColor=none;" parent="1" vertex="1">
          <mxGeometry x="415" y="445" width="120" height="65" as="geometry" />
        </mxCell>
        <mxCell id="triton-backend" value="Triton" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="560" y="340" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="triton-opt" value="Block&#xa;Pipelining&#xa;Split-K" style="rounded=0;whiteSpace=wrap;html=1;align=center;fontSize=10;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="565" y="365" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="nki-backend" value="NKI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="560" y="440" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="nki-opt" value="SBUF&#xa;DMA&#xa;BF16" style="rounded=0;whiteSpace=wrap;html=1;align=center;fontSize=10;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="565" y="460" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="cudnn-backend" value="cuDNN" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="680" y="340" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="cudnn-opt" value="Algorithm&#xa;MathType&#xa;Workspace" style="rounded=0;whiteSpace=wrap;html=1;align=center;fontSize=10;fillColor=#ffffff" parent="1" vertex="1">
          <mxGeometry x="685" y="365" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="mkl-backend" value="MKL" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="680" y="440" width="100" height="80" as="geometry" />
        </mxCell>
        <mxCell id="mkl-opt" value="Threading&#xa;BLAS&#xa;Fast MM" style="rounded=0;whiteSpace=wrap;html=1;align=center;fontSize=10;fillColor=#ffffff;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="685" y="460" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hardware-title" value="Target Hardware" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="100" y="560" width="1000" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hw-nvidia" value="NVIDIA GPU&#xa;(Ampere/Hopper)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450" parent="1" vertex="1">
          <mxGeometry x="110" y="610" width="130" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-cpu" value="x86/ARM CPU&#xa;(Intel/AMD/Apple)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366" parent="1" vertex="1">
          <mxGeometry x="260" y="610" width="130" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-apple" value="Apple Silicon&#xa;(M1/M2/M3)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf" parent="1" vertex="1">
          <mxGeometry x="410" y="610" width="130" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-aws" value="AWS Neuron&#xa;(Inferentia/Trainium)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="560" y="610" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hw-accel" value="Accelerators&#xa;(cuDNN/MKL)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6" parent="1" vertex="1">
          <mxGeometry x="740" y="610" width="130" height="60" as="geometry" />
        </mxCell>
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;exitX=0.5;exitY=1;" parent="1" source="python-layer" target="backend-manager" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-cuda-hw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1" parent="1" source="cuda-backend" target="hw-nvidia" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-cpu-hw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1" parent="1" source="cpu-backend" target="hw-cpu" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-mps-hw" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1" parent="1" source="mps-backend" target="hw-apple" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="stats" value="YiRage Stats&#xa;━━━━━━━━━━&#xa;7 Backends&#xa;42+ Optimizers&#xa;5 Search Strategies&#xa;17K+ Lines of Code&#xa;M3 Mac Ready ✓" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=center;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="900" y="360" width="180" height="140" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="930" y="615" width="60" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend1" value="GPU Backend" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10" parent="1" vertex="1">
          <mxGeometry x="1010" y="610" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend2" value="CPU Backend" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10" parent="1" vertex="1">
          <mxGeometry x="1010" y="645" width="90" height="25" as="geometry" />
        </mxCell>
        <mxCell id="legend3" value="Specialized" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=10" parent="1" vertex="1">
          <mxGeometry x="1010" y="680" width="90" height="25" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
